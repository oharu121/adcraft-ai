Option 2: Use Structured Output API (Best of both worlds)

  Keep 2.5 Flash but use proper structured output instead of prompting:

  const request = {
    contents: [
      {
        parts: [{ text: prompt }],
      },
    ],
    generationConfig: {
      temperature: 0.7,
      maxOutputTokens: 4096,
      responseMimeType: "application/json",  // Force JSON output
      responseSchema: {  // Define exact JSON structure
        type: "object",
        properties: {
          quickActions: {
            type: "array",
            items: { type: "string" }
          }
        }
      }
    },
  };

  Pros:
  - ✅ Enforces clean JSON (no markdown)
  - ✅ Better 2.5 Flash reasoning
  - ✅ Type-safe output

  Cons:
  - More complex setup
  - Still experimental in 2.5

 My honest opinion: This is NOT feasible for your case right now. Here's why:

  Critical Issues with Structured Output API

  Based on my earlier search, structured output is currently broken in Gemini 2.5:
  - ❌ P1 (Priority 1) bug - still active in Oct 2025
  - ❌ "response.text includes markdown ticks and response.parsed is None"
  - ❌ Function calling + JSON breaks completely
  - ❌ You'd be fighting against a known Google API bug

  Your Specific Situation Makes This Worse

  1. Multiple Response Schemas Needed:
    - Product Intelligence analysis (complex nested JSON)
    - Quick Actions (array of strings)
    - Style Options (nested objects with arrays)
    - Creative Director responses (different structure)
    - Scene planning (yet another structure)
02
  You'd need to define 10+ different schemas across your codebase!
  2. Deadline Pressure:
    - AI Agent Hackathon deadline: Sept 24, 2025
    - $300 budget - can't waste on debugging Google's broken API
    - You need working now, not "eventually when Google fixes it"
  3. Current Solution is Simpler:
    - Markdown stripping: 2 lines of code
    - Works immediately
    - Battle-tested pattern

  My Recommendation: Simple Markdown Cleanup

  Keep gemini-2.5-flash + 4096 tokens, add this utility:

  // lib/utils/json-cleanup.ts
  export function cleanJsonResponse(text: string): string {
    // Remove markdown code blocks that Gemini 2.5 Flash adds
    return text
      .replace(/^```json\s*\n?/, '')  // Remove opening ```json
      .replace(/\n?```\s*$/, '')       // Remove closing ```
      .trim();
  }

  // Usage in your code:
  const textContent = data.candidates?.[0]?.content?.parts?.[0]?.text;
  const cleanJson = cleanJsonResponse(textContent);
  return JSON.parse(cleanJson);

  Why this is better for you:
  - ✅ Works immediately with current code
  - ✅ Handles the actual problem (markdown wrapping)
  - ✅ No schema definition needed
  - ✅ One utility function fixes all cases
  - ✅ Production-ready TODAY

  Would you like me to implement this simple cleanup approach instead?